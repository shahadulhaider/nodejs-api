FROM node:18-alpine

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm install

COPY . .

EXPOSE 3000

ARG APP_PORT
ARG MONGO_DB_URI
ARG MONGO_DB_NAME
ARG REDIS_HOST
ARG REDIS_PORT
ARG CACHE_TTL

ENV APP_PORT=$APP_PORT
ENV MONGO_DB_URI=$MONGO_DB_URI
ENV MONGO_DB_NAME=$MONGO_DB_NAME
ENV REDIS_HOST=$REDIS_HOST
ENV REDIS_PORT=$REDIS_PORT
ENV CACHE_TTL=$CACHE_TTL

CMD ["npm", "start"]
